
    IRC GNOME SHELL
============

slaf:  magpie : http://pastebin.com/28BZikPW
slaf:  magpie, in this case, as there's no dependancy to GS you can run it with Gjs in the same dir as focusCaretTracker.js ( unshift trick, remember, jasper don't like it )
slaf:  magpie, but it's just for testing OK ? 
Jasper:  slaf, just copy the class to a standalone test.
magpie:  it's only running signals lang and atspi 
slaf:  Jasper, well i can do that, but here it's just for rapid testing
slaf:  magpie, i think now : you must put atspi.exit() after using it
slaf:  magpie, and perhaps add some existence check in code, like to be sure for example Atspi.EventListener.new return TRUE
slaf:  magpie, and atspi exception too 
slaf:  magpie, there's an error with GI but it work anyway
magpie:  ultimately I need to make the tracker work in the magnifier so connecting it in a standalone is not really an option for me I need to make it work with the imports that the magnifier uses 
slaf:  magpie, atspi API via GI is a mess here
slaf:  magpie, until there's no GS dependancy, you can test this way
slaf:  magpie, after you must integrate it in GS and alt+f2 r at any change in code to reload GS
magpie:  slaf the tracker has not got a GS dependency but the magnifier has 
slaf:  magpie, but it's GS main code who launch your tracker isn't it ?
magpie:  the imports are standard library's i've never had any problems with them that's why I am confused at your atspi error and where came from. My issue (as far as I understand it) is the St and Shell libraries 
magpie:  can you tell me what exactly you did to get that error slaf and help me to see what you mean ?
slaf:  magpie, your jhbuild installation work now ?
magpie:  yeah slaf perfect
magpie:  but i just closed my terminal and now I can't log back into that session
magpie:  so that's the next thing
slaf:  magpie, this error : (gjs:18853): Gjs-WARNING **: JS ERROR: Error: Function Atspi.register_no_data has a GDestroyNotify but no user_data, not supported 
slaf:  yes, but between C api and js API via GI, it's completly different here
slaf:  magpie, it's in atspi  i think , perhaps the typelib
magpie:  what is?
magpie:  the mistake?
slaf:  magpie, yes the error


Slaf ran his own interpretation 

================================

imports.searchPath.unshift('.');
const Mainloop = imports.mainloop;

const Tracker = imports.focusCaretTracker;
var fct = new Tracker.FocusCaretTracker();

fct.registerFocusListener();
fct.registerCaretListener();
fct.connect('focus-changed', focusChanged);
fct.connect('caret-changed', caretChanged);
Mainloop.run('runMainloop');

function focusChanged(caller, event) {
    print("focus changed :");
    showEvent(event);
}

function caretChanged(caller, event) {
    print("caret changed");
    showEvent(event);
}

function showEvent(event) {
    var type = event.type;
    var accessible = event.source;
    
    var sourceName = accessible.get_name();
    var description = accessible.get_description();
    
    print('type: '+type);
    print(' source: '+sourceName);
    print(' description: '+description);
}
